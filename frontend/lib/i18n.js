export const SUPPORTED_LANGUAGES = ["ru", "en"];

const RU_NEAR_LANGUAGE_PREFIXES = ["ru", "kk", "az", "ky", "uz", "tg", "be", "uk", "hy"];

export const translations = {
  ru: {
    appTitle: "Smart Wishlist",
    login: "Вход",
    register: "Регистрация",
    email: "Email",
    emailOrUsername: "Email или username",
    password: "Пароль",
    displayName: "Ваше имя",
    username: "Username",
    createAccount: "Создать аккаунт",
    signIn: "Войти",
    wait: "Подождите...",
    haveAccount: "Уже есть аккаунт? Войти",
    noAccount: "Нет аккаунта? Зарегистрироваться",
    hello: "Привет",
    checkingSession: "Проверяю сессию...",
    ownerMode: "Это owner-режим. Username:",
    wishlistsTab: "Вишлисты",
    friendsTab: "Друзья",
    myWishlists: "Мои вишлисты",
    sharedWishlists: "Вишлисты, которыми поделились",
    newWishlists: "Новые вишлисты",
    noNewWishlists: "Пока новых уведомлений нет.",
    activityUpdates: "Обновления по вкладам",
    noActivityUpdates: "Новых обновлений нет.",
    redistributedOnlyNotice: "Товар \"{item}\" удалён из \"{wishlist}\". {moved} ₽ перенесено на другие подарки по приоритету.",
    refundedOnlyNotice: "Товар \"{item}\" удалён из \"{wishlist}\". {refunded} ₽ возвращено в твой баланс.",
    redistributedAndRefundedNotice: "Товар \"{item}\" удалён из \"{wishlist}\". {moved} ₽ перенесено, {refunded} ₽ возвращено.",
    emptyWishlists: "Пока пусто. Создай первый список.",
    emptySharedWishlists: "Пока друзья не поделились с вами публичными списками.",
    createWishlist: "Создать новый список",
    createWishlistBtn: "Создать список",
    wishlistTitlePlaceholder: "Например: День рождения 2026",
    recipientModeSelf: "Для себя",
    recipientModeFriend: "Для друга",
    recipientInput: "Username или имя",
    nextStep: "Далее",
    prevStep: "Назад",
    privacyStepTitle: "Кого скрыть",
    hideFromOthers: "Скрыть от других пользователей",
    hideFromFoundUser: "Скрыть подарок от",
    hideFromUsers: "Дополнительно скрыть от пользователей:",
    minContributionInput: "Минимальный вклад, ₽",
    friends: "Друзья",
    sendRequest: "Отправить",
    friendRequestVisibleWishlists: "Какие твои вишлисты будут видны этому другу",
    friendAcceptVisibleWishlists: "Какие твои вишлисты будут видны после принятия",
    requestByUsernamePlaceholder: "Отправить запрос по username",
    incomingRequests: "Входящие запросы",
    outgoingRequests: "Исходящие запросы",
    noIncomingRequests: "Нет входящих запросов.",
    noOutgoingRequests: "Нет исходящих запросов.",
    noFriends: "Пока нет друзей.",
    accept: "Принять",
    reject: "Отклонить",
    addItem: "Добавить товар",
    productUrl: "Ссылка на товар",
    itemTitle: "Название",
    imageUrl: "URL картинки",
    uploadImage: "Загрузить фото",
    imageTooLarge: "Файл слишком большой (макс. 5 МБ)",
    imageReadError: "Не удалось прочитать файл",
    targetPrice: "Цена, ₽",
    itemPriority: "Приоритет подарка",
    priorityLow: "Низкий",
    priorityMedium: "Средний",
    priorityHigh: "Высокий",
    saveItem: "Сохранить товар",
    autofillToggle: "Автозаполнение (экспериментальная функция)",
    autofillInProgress: "Пробую подтянуть данные по ссылке...",
    currencyConverted: "Конвертация валюты",
    loadingWishlist: "Загружаю вишлист...",
    loginToViewWishlist: "Войдите для просмотра",
    noAccessToWishlist: "У вас нет доступа к данному списку",
    wishlistEmpty: "Список пока пустой. Добавьте первый подарок.",
    ownerHeader: "Ты владелец списка. Имена резервов и вкладов скрыты для сохранения сюрприза.",
    guestHeader: "Публичный просмотр без регистрации",
    backToList: "К списку",
    makePrivate: "Сделать непубличным",
    makePublic: "Сделать публичным",
    dueDate: "Срок исполнения",
    deleteWishlist: "Удалить список",
    deleteAfterDueDate: "Удаление станет доступно после даты исполнения.",
    liveUpdates: "Live-обновления",
    noEvents: "Пока нет событий.",
    giftFree: "Подарок свободен",
    giftReserved: "Подарок уже зарезервирован",
    reservedByYou: "Зарезервировано тобой",
    removedPrefix: "Товар снят:",
    reserve: "Забронировать",
    unreserve: "Снять резерв",
    contribute: "Внести вклад",
    minContribution: "Минимальный вклад:",
    contributionAccepted: "Учтено:",
    contributionRefunded: "Возврат:",
    contributionProportional: "Переплата распределена пропорционально вкладам.",
    creditUsed: "Использовано из прошлого вклада:",
    chargedNow: "Списано сейчас:",
    creditDropped: "Сброшено после переноса:",
    beResponsible: "Стать ответственным",
    youResponsible: "Ты ответственный",
    unsetResponsible: "Снять ответственность",
    removeItem: "Удалить товар",
    fullyFundedLocked: "Нельзя удалить полностью профинансированный подарок",
    removeReasonPrompt: "Причина удаления",
    removeReasonDefault: "Он будет удален",
    ownerNameLabel: "Твоё имя/ник",
    openProduct: "Открыть товар",
    goal: "Цель:",
    collected: "Собрано:",
    invested: "Вложено",
    logout: "Выйти",
    switchToLight: "Светлая тема",
    switchToDark: "Тёмная тема",
    langRu: "RU",
    langEn: "EN",
  },
  en: {
    appTitle: "Smart Wishlist",
    login: "Login",
    register: "Register",
    email: "Email",
    emailOrUsername: "Email or username",
    password: "Password",
    displayName: "Display name",
    username: "Username",
    createAccount: "Create account",
    signIn: "Sign in",
    wait: "Please wait...",
    haveAccount: "Already have an account? Sign in",
    noAccount: "No account? Register",
    hello: "Hello",
    checkingSession: "Checking session...",
    ownerMode: "Owner mode. Username:",
    wishlistsTab: "Wishlists",
    friendsTab: "Friends",
    myWishlists: "My wishlists",
    sharedWishlists: "Shared with you",
    newWishlists: "New wishlists",
    noNewWishlists: "No new notifications yet.",
    activityUpdates: "Contribution updates",
    noActivityUpdates: "No new updates.",
    redistributedOnlyNotice: "Item \"{item}\" was removed from \"{wishlist}\". {moved} RUB moved to other gifts by priority.",
    refundedOnlyNotice: "Item \"{item}\" was removed from \"{wishlist}\". {refunded} RUB returned to your balance.",
    redistributedAndRefundedNotice: "Item \"{item}\" was removed from \"{wishlist}\". {moved} RUB moved, {refunded} RUB returned.",
    emptyWishlists: "No wishlists yet. Create your first one.",
    emptySharedWishlists: "No shared public wishlists from your friends yet.",
    createWishlist: "Create a new wishlist",
    createWishlistBtn: "Create wishlist",
    wishlistTitlePlaceholder: "For example: Birthday 2026",
    recipientModeSelf: "For myself",
    recipientModeFriend: "For a friend",
    recipientInput: "Username or name",
    nextStep: "Next",
    prevStep: "Back",
    privacyStepTitle: "Visibility",
    hideFromOthers: "Hide from other users",
    hideFromFoundUser: "Hide gift from",
    hideFromUsers: "Additionally hide from users:",
    minContributionInput: "Minimum contribution",
    friends: "Friends",
    sendRequest: "Send",
    friendRequestVisibleWishlists: "Choose which of your wishlists this friend can see",
    friendAcceptVisibleWishlists: "Choose which of your wishlists will be visible after accept",
    requestByUsernamePlaceholder: "Send request by username",
    incomingRequests: "Incoming requests",
    outgoingRequests: "Outgoing requests",
    noIncomingRequests: "No incoming requests.",
    noOutgoingRequests: "No outgoing requests.",
    noFriends: "No friends yet.",
    accept: "Accept",
    reject: "Reject",
    addItem: "Add item",
    productUrl: "Product URL",
    itemTitle: "Title",
    imageUrl: "Image URL",
    uploadImage: "Upload image",
    imageTooLarge: "File is too large (max 5 MB)",
    imageReadError: "Failed to read file",
    targetPrice: "Price",
    itemPriority: "Gift priority",
    priorityLow: "Low",
    priorityMedium: "Medium",
    priorityHigh: "High",
    saveItem: "Save item",
    autofillToggle: "Autofill (experimental feature)",
    autofillInProgress: "Trying to fetch product data...",
    currencyConverted: "Currency conversion",
    loadingWishlist: "Loading wishlist...",
    loginToViewWishlist: "Log in to view this wishlist",
    noAccessToWishlist: "You do not have access to this wishlist",
    wishlistEmpty: "Wishlist is empty. Add the first gift.",
    ownerHeader: "You are the owner. Reservation and contribution names are hidden to keep surprise.",
    guestHeader: "Public view without registration",
    backToList: "Back to list",
    makePrivate: "Make private",
    makePublic: "Make public",
    dueDate: "Due date",
    deleteWishlist: "Delete wishlist",
    deleteAfterDueDate: "Deletion is available only after due date.",
    liveUpdates: "Live updates",
    noEvents: "No events yet.",
    giftFree: "Gift is free",
    giftReserved: "Gift is already reserved",
    reservedByYou: "Reserved by you",
    removedPrefix: "Item removed:",
    reserve: "Reserve",
    unreserve: "Cancel reservation",
    contribute: "Contribute",
    minContribution: "Minimum contribution:",
    contributionAccepted: "Accepted:",
    contributionRefunded: "Refund:",
    contributionProportional: "Overpayment was distributed proportionally.",
    creditUsed: "Used from previous contribution:",
    chargedNow: "Charged now:",
    creditDropped: "Dropped after transfer:",
    beResponsible: "Become responsible",
    youResponsible: "You are responsible",
    unsetResponsible: "Remove responsibility",
    removeItem: "Remove item",
    fullyFundedLocked: "You cannot remove a fully funded gift",
    removeReasonPrompt: "Remove reason",
    removeReasonDefault: "It will be removed",
    ownerNameLabel: "Your name/nickname",
    openProduct: "Open product",
    goal: "Goal:",
    collected: "Collected:",
    invested: "Invested",
    logout: "Log out",
    switchToLight: "Light theme",
    switchToDark: "Dark theme",
    langRu: "RU",
    langEn: "EN",
  },
};

export function resolveLanguageFromBrowser() {
  if (typeof window === "undefined") return "en";

  const locales = [
    ...(window.navigator.languages || []),
    window.navigator.language || "",
  ]
    .map((value) => String(value).toLowerCase())
    .filter(Boolean);

  for (const locale of locales) {
    const prefix = locale.split("-")[0];
    if (RU_NEAR_LANGUAGE_PREFIXES.includes(prefix)) return "ru";
  }

  return "en";
}

export function t(lang, key) {
  return translations[lang]?.[key] || translations.en[key] || key;
}
